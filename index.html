<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rental Investment Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #fafbfc;
            min-height: 100vh;
            padding: 20px;
            color: #0f172a;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1280px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 48px;
            padding: 60px 20px 40px;
        }
        
        h1 {
            color: #0f172a;
            margin-bottom: 12px;
            font-size: 3em;
            font-weight: 700;
            letter-spacing: -1.5px;
        }
        
        .subtitle {
            color: #64748b;
            font-size: 1.125rem;
            font-weight: 400;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .section {
            background: white;
            padding: 32px;
            border-radius: 12px;
            margin-bottom: 24px;
            border: 1px solid #e2e8f0;
            transition: box-shadow 0.2s;
        }
        
        .section:hover {
            box-shadow: 0 1px 3px rgba(0,0,0,0.04), 0 4px 12px rgba(0,0,0,0.04);
        }
        
        .section-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #0f172a;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            font-weight: 500;
            color: #0f172a;
            margin-bottom: 8px;
            font-size: 0.875rem;
        }
        
        .help-text {
            font-size: 0.8125rem;
            color: #64748b;
            margin-top: 6px;
            line-height: 1.5;
        }
        
        input[type="number"], input[type="text"] {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            font-size: 0.9375rem;
            transition: all 0.15s ease;
            background: white;
            color: #0f172a;
        }
        
        input[type="number"]:focus, input[type="text"]:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.08);
        }
        
        input[type="number"]:hover, input[type="text"]:hover {
            border-color: #94a3b8;
        }
        
        .button-bar {
            display: flex;
            gap: 12px;
            margin: 24px 0;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 0.9375rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            white-space: nowrap;
            min-height: 44px;
        }
        
        .btn-calculate {
            background: #2563eb;
            color: white;
            padding: 14px 32px;
            font-size: 1rem;
            font-weight: 600;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }
        
        .btn-calculate:hover {
            background: #1d4ed8;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.25);
            transform: translateY(-1px);
        }
        
        .btn-calculate:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(37, 99, 235, 0.3);
        }
        
        .btn-secondary {
            background: white;
            color: #0f172a;
            border: 1px solid #cbd5e1;
            padding: 11px 20px;
        }
        
        .btn-secondary:hover {
            background: #f8fafc;
            border-color: #94a3b8;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .btn-secondary:active {
            background: #f1f5f9;
        }
        
        .btn-load {
            background: white;
            color: #0f172a;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            padding: 11px 20px;
            font-size: 0.9375rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            white-space: nowrap;
            min-height: 44px;
            position: relative;
            overflow: hidden;
        }
        
        .btn-load:hover {
            background: #f8fafc;
            border-color: #94a3b8;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .btn-load:active {
            background: #f1f5f9;
        }
        
        .btn-load input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }
        
        .button-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .results-highlight {
            background: white;
            padding: 40px;
            border-radius: 12px;
            margin-bottom: 24px;
            border: 1px solid #e2e8f0;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 24px;
        }
        
        .result-item {
            background: #f8fafc;
            padding: 24px;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s;
        }
        
        .result-item:hover {
            border-color: #cbd5e1;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        
        .result-label {
            font-size: 0.875rem;
            color: #64748b;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .result-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: #0f172a;
            line-height: 1.2;
        }
        
        .result-value.positive {
            color: #22c55e;
        }
        
        .result-value.negative {
            color: #ef4444;
        }
        
        .result-value.highlight {
            color: #2563eb;
        }
        
        .info-box {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            color: #1e40af;
            line-height: 1.7;
        }
        
        .info-box strong {
            color: #1e3a8a;
        }
        
        .warning-box {
            background: #fef3c7;
            border: 1px solid #fde68a;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            color: #92400e;
            line-height: 1.7;
        }
        
        .warning-box strong {
            color: #78350f;
        }
        
        .print-date {
            text-align: center;
            color: #64748b;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }
        
        .property-address {
            text-align: center;
            color: #0f172a;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
            padding: 12px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }
            
            .input-grid {
                grid-template-columns: 1fr;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .button-bar {
                flex-direction: row;
                width: 100%;
            }
            
            button, .btn-load {
                flex: 1;
                min-width: 140px;
            }
            
            .btn-calculate {
                width: 100%;
            }
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                max-width: 100%;
            }
            
            .header {
                padding: 30px 20px 20px;
                border-bottom: 3px solid #2563eb;
                page-break-after: avoid;
            }
            
            h1 {
                font-size: 2.25em;
                color: #0f172a;
                margin-bottom: 8px;
            }
            
            .subtitle {
                color: #64748b;
                font-size: 1rem;
            }
            
            .button-bar, button, .btn-load, #actionButtons {
                display: none !important;
            }
            
            .section {
                page-break-inside: avoid;
                box-shadow: none;
                border: 1px solid #e2e8f0;
                margin-bottom: 20px;
                padding: 24px;
            }
            
            .section-title {
                color: #2563eb;
                font-size: 1.125rem;
                font-weight: 600;
                margin-bottom: 16px;
                padding-bottom: 8px;
                border-bottom: 2px solid #e2e8f0;
            }
            
            .results-highlight {
                box-shadow: none;
                border: 2px solid #2563eb;
                page-break-inside: avoid;
                padding: 30px;
                margin-bottom: 20px;
            }
            
            .results-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
            }
            
            .result-item {
                background: white;
                border: 1px solid #e2e8f0;
                padding: 16px;
                page-break-inside: avoid;
            }
            
            .result-label {
                font-size: 0.8125rem;
                color: #64748b;
                margin-bottom: 6px;
            }
            
            .result-value {
                font-size: 1.5rem;
                color: #0f172a;
            }
            
            .result-value.positive {
                color: #16a34a;
            }
            
            .result-value.negative {
                color: #dc2626;
            }
            
            .result-value.highlight {
                color: #2563eb;
            }
            
            .info-box {
                background: #f8fafc;
                border: 1px solid #cbd5e1;
                page-break-inside: avoid;
                padding: 16px;
                margin: 16px 0;
            }
            
            .warning-box {
                background: #fef9e7;
                border: 1px solid #fde68a;
                page-break-inside: avoid;
                padding: 16px;
                margin: 16px 0;
            }
            
            .property-address {
                font-size: 1.125rem;
                font-weight: 600;
                text-align: center;
                margin-bottom: 16px;
                padding: 10px;
                background: #f8fafc;
                border: 1px solid #e2e8f0;
                page-break-after: avoid;
            }
            
            .print-date {
                text-align: center;
                color: #64748b;
                font-size: 0.875rem;
                margin-bottom: 20px;
                page-break-after: avoid;
            }
            
            .input-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
            }
            
            .input-group {
                page-break-inside: avoid;
                margin-bottom: 0;
            }
            
            label {
                font-size: 0.8125rem;
                color: #475569;
                font-weight: 600;
            }
            
            input {
                border: 1px solid #cbd5e1;
                background: #f8fafc;
                padding: 8px 10px;
                font-size: 0.875rem;
                color: #0f172a;
            }
            
            .help-text {
                display: none;
            }
            
            /* Ensure proper page breaks */
            .section:first-of-type {
                page-break-before: avoid;
            }
            
            /* Add page numbers */
            @page {
                margin: 0.75in;
                @bottom-right {
                    content: "Page " counter(page) " of " counter(pages);
                    font-size: 9pt;
                    color: #64748b;
                }
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Rental Investment Calculator</h1>
            <div class="subtitle">Calculate your rental property ROI, cash flow, and key investment metrics</div>
        </div>

        <div class="section">
            <div class="section-title">Property Information</div>
            <div class="input-grid">
                <div class="input-group">
                    <label for="propertyAddress">Property Address (Optional)</label>
                    <input type="text" id="propertyAddress" placeholder="123 Main St, City, State">
                    <div class="help-text">For reference on reports and saved data</div>
                </div>
                <div class="input-group">
                    <label for="purchasePrice">Purchase Price</label>
                    <input type="number" id="purchasePrice" value="300000" step="1000" min="0">
                    <div class="help-text">Total property acquisition price</div>
                </div>
                <div class="input-group">
                    <label for="downPayment">Down Payment (%)</label>
                    <input type="number" id="downPayment" value="20" step="1" min="0" max="100">
                    <div class="help-text">Percentage of purchase price</div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Financing Details</div>
            <div class="input-grid">
                <div class="input-group">
                    <label for="interestRate">Interest Rate (%)</label>
                    <input type="number" id="interestRate" value="6.5" step="0.01" min="0">
                    <div class="help-text">Annual mortgage interest rate</div>
                </div>
                <div class="input-group">
                    <label for="loanTerm">Loan Term (years)</label>
                    <input type="number" id="loanTerm" value="30" step="1" min="1">
                    <div class="help-text">Mortgage duration in years</div>
                </div>
                <div class="input-group">
                    <label for="closingCosts">Closing Costs</label>
                    <input type="number" id="closingCosts" value="6000" step="100" min="0">
                    <div class="help-text">One-time closing expenses</div>
                </div>
                <div class="input-group">
                    <label for="oneTimeCosts">Other One-Time Costs</label>
                    <input type="number" id="oneTimeCosts" value="5000" step="100" min="0">
                    <div class="help-text">Repairs, improvements, initial costs</div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Income & Expenses</div>
            <div class="input-grid">
                <div class="input-group">
                    <label for="monthlyRent">Monthly Rent</label>
                    <input type="number" id="monthlyRent" value="2500" step="10" min="0">
                    <div class="help-text">Expected monthly rental income</div>
                </div>
                <div class="input-group">
                    <label for="propertyTax">Annual Property Tax</label>
                    <input type="number" id="propertyTax" value="3600" step="100" min="0">
                    <div class="help-text">Yearly property tax amount</div>
                </div>
                <div class="input-group">
                    <label for="insurance">Annual Insurance</label>
                    <input type="number" id="insurance" value="1200" step="10" min="0">
                    <div class="help-text">Yearly property insurance</div>
                </div>
                <div class="input-group">
                    <label for="maintenance">Monthly Maintenance</label>
                    <input type="number" id="maintenance" value="200" step="10" min="0">
                    <div class="help-text">Average monthly upkeep costs</div>
                </div>
                <div class="input-group">
                    <label for="hoaFees">Monthly HOA Fees</label>
                    <input type="number" id="hoaFees" value="0" step="10" min="0">
                    <div class="help-text">Homeowners association fees</div>
                </div>
                <div class="input-group">
                    <label for="otherCosts">Other Monthly Costs</label>
                    <input type="number" id="otherCosts" value="0" step="10" min="0">
                    <div class="help-text">Utilities, landscaping, etc.</div>
                </div>
                <div class="input-group">
                    <label for="vacancy">Vacancy Rate (%)</label>
                    <input type="number" id="vacancy" value="5" step="1" min="0" max="100">
                    <div class="help-text">Expected vacancy percentage</div>
                </div>
                <div class="input-group">
                    <label for="propertyMgmt">Property Management (%)</label>
                    <input type="number" id="propertyMgmt" value="8" step="1" min="0" max="100">
                    <div class="help-text">Management fee as % of rent</div>
                </div>
            </div>
        </div>

        <div class="button-bar" style="margin-top: 40px;">
            <button class="btn-calculate" onclick="calculateInvestment()">Calculate Investment</button>
        </div>

        <div class="button-bar" style="margin-top: 16px;">
            <button class="btn-secondary" onclick="saveData()">💾 Save Data</button>
            <label class="btn-load">
                📁 Load Data
                <input type="file" accept=".json" onchange="loadData(event)">
            </label>
        </div>

        <div id="results" style="display: none;">
            <!-- Results will be displayed here -->
        </div>

        <div id="actionButtons" class="button-bar" style="display: none; margin-top: 24px; margin-bottom: 40px;">
            <button class="btn-secondary" onclick="printReport()">🖨️ Print Report</button>
            <button class="btn-secondary" onclick="emailReport()">📧 Email Report</button>
        </div>
    </div>

    <script>
        function calculateInvestment() {
            const purchasePrice = parseFloat(document.getElementById('purchasePrice').value) || 0;
            const downPaymentPct = parseFloat(document.getElementById('downPayment').value) || 0;
            const interestRate = parseFloat(document.getElementById('interestRate').value) || 0;
            const loanTerm = parseFloat(document.getElementById('loanTerm').value) || 0;
            const closingCosts = parseFloat(document.getElementById('closingCosts').value) || 0;
            const oneTimeCosts = parseFloat(document.getElementById('oneTimeCosts').value) || 0;
            const monthlyRent = parseFloat(document.getElementById('monthlyRent').value) || 0;
            const propertyTax = parseFloat(document.getElementById('propertyTax').value) || 0;
            const insurance = parseFloat(document.getElementById('insurance').value) || 0;
            const maintenance = parseFloat(document.getElementById('maintenance').value) || 0;
            const hoaFees = parseFloat(document.getElementById('hoaFees').value) || 0;
            const otherCosts = parseFloat(document.getElementById('otherCosts').value) || 0;
            const vacancyRate = parseFloat(document.getElementById('vacancy').value) || 0;
            const propertyMgmt = parseFloat(document.getElementById('propertyMgmt').value) || 0;

            const downPaymentAmount = purchasePrice * (downPaymentPct / 100);
            const loanAmount = purchasePrice - downPaymentAmount;
            const monthlyInterestRate = (interestRate / 100) / 12;
            const numberOfPayments = loanTerm * 12;

            let monthlyMortgage = 0;
            if (loanAmount > 0 && monthlyInterestRate > 0) {
                monthlyMortgage = loanAmount * (monthlyInterestRate * Math.pow(1 + monthlyInterestRate, numberOfPayments)) / (Math.pow(1 + monthlyInterestRate, numberOfPayments) - 1);
            }

            const effectiveMonthlyRent = monthlyRent * (1 - vacancyRate / 100);
            const propertyMgmtFee = effectiveMonthlyRent * (propertyMgmt / 100);
            const monthlyPropertyTax = propertyTax / 12;
            const monthlyInsurance = insurance / 12;

            const totalMonthlyExpenses = monthlyMortgage + monthlyPropertyTax + monthlyInsurance + maintenance + hoaFees + otherCosts + propertyMgmtFee;
            const monthlyCashFlow = effectiveMonthlyRent - totalMonthlyExpenses;
            const annualCashFlow = monthlyCashFlow * 12;

            const totalInvestment = downPaymentAmount + closingCosts + oneTimeCosts;
            const cashOnCashReturn = totalInvestment > 0 ? (annualCashFlow / totalInvestment) * 100 : 0;

            const annualIncome = monthlyRent * 12 * (1 - vacancyRate / 100);
            const annualOperatingExpenses = (monthlyPropertyTax + monthlyInsurance + maintenance + hoaFees + otherCosts + propertyMgmtFee) * 12;
            const noi = annualIncome - annualOperatingExpenses;
            const capRate = purchasePrice > 0 ? (noi / purchasePrice) * 100 : 0;

            displayResults({
                totalInvestment,
                monthlyMortgage,
                effectiveMonthlyRent,
                totalMonthlyExpenses,
                monthlyCashFlow,
                annualCashFlow,
                cashOnCashReturn,
                capRate,
                noi,
                downPaymentAmount
            });
        }

        function displayResults(results) {
            const resultsDiv = document.getElementById('results');
            const actionButtons = document.getElementById('actionButtons');
            
            resultsDiv.style.display = 'block';
            actionButtons.style.display = 'flex';
            
            const address = document.getElementById('propertyAddress').value;
            const today = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
            
            const addressHTML = address ? `<div class="property-address">📍 ${address}</div>` : '';
            
            let html = '<div class="results-highlight">';
            html += '<div class="section-title">Investment Analysis</div>';
            html += '<div class="print-date">Report Date: ' + today + '</div>';
            html += addressHTML;
            html += '<div class="results-grid">';
            
            // Key Metrics
            html += createResultCard('Total Investment', results.totalInvestment, 'highlight');
            html += createResultCard('Monthly Cash Flow', results.monthlyCashFlow, results.monthlyCashFlow >= 0 ? 'positive' : 'negative', true);
            html += createResultCard('Annual Cash Flow', results.annualCashFlow, results.annualCashFlow >= 0 ? 'positive' : 'negative', true);
            html += createResultCard('Cash-on-Cash Return', results.cashOnCashReturn, results.cashOnCashReturn >= 0 ? 'positive' : 'negative', false, true);
            html += createResultCard('Cap Rate', results.capRate, results.capRate >= 0 ? 'positive' : 'negative', false, true);
            html += createResultCard('Net Operating Income', results.noi, results.noi >= 0 ? 'positive' : 'negative', true);
            
            html += '</div></div>';
            
            // Breakdown Section
            html += '<div class="section">';
            html += '<div class="section-title">Monthly Breakdown</div>';
            html += '<div class="results-grid">';
            html += createResultCard('Effective Monthly Rent', results.effectiveMonthlyRent, null);
            html += createResultCard('Monthly Mortgage', results.monthlyMortgage, null);
            html += createResultCard('Total Monthly Expenses', results.totalMonthlyExpenses, null);
            html += '</div>';
            html += '</div>';
            
            // Investment Insights
            html += generateInsights(results);
            
            resultsDiv.innerHTML = html;
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function createResultCard(label, value, colorClass = null, showSign = false, isPercent = false) {
            let displayValue;
            const numValue = typeof value === 'number' ? value : parseFloat(value);
            
            if (isPercent) {
                const sign = showSign && numValue >= 0 ? '+' : '';
                displayValue = sign + numValue.toFixed(2) + '%';
            } else {
                const sign = showSign && numValue >= 0 ? '+' : '';
                displayValue = (numValue < 0 && !showSign ? '-' : sign) + formatCurrency(Math.abs(numValue));
            }
            
            const valueClass = colorClass ? `result-value ${colorClass}` : 'result-value';
            
            return `
                <div class="result-item">
                    <div class="result-label">${label}</div>
                    <div class="${valueClass}">${displayValue}</div>
                </div>
            `;
        }

        function generateInsights(results) {
            let html = '<div class="section">';
            html += '<div class="section-title">Investment Insights</div>';
            
            // Cash Flow Analysis
            if (results.monthlyCashFlow > 0) {
                html += '<div class="info-box">';
                html += '<strong>✅ Positive Cash Flow</strong><br><br>';
                html += 'This property generates positive monthly cash flow of <strong>' + formatCurrency(results.monthlyCashFlow) + '</strong>, ';
                html += 'meaning it pays for itself and puts money in your pocket each month!';
                html += '</div>';
            } else if (results.monthlyCashFlow < 0) {
                html += '<div class="warning-box">';
                html += '<strong>⚠️ Negative Cash Flow</strong><br><br>';
                html += 'This property requires you to contribute <strong>' + formatCurrency(Math.abs(results.monthlyCashFlow)) + '</strong> ';
                html += 'per month to cover expenses. Consider negotiating a lower purchase price or increasing rent.';
                html += '</div>';
            }
            
            // ROI Analysis
            html += '<div class="info-box">';
            html += '<strong>📊 Return on Investment</strong><br><br>';
            
            if (results.cashOnCashReturn >= 8) {
                html += '• <strong>Excellent!</strong> Your cash-on-cash return of ' + results.cashOnCashReturn.toFixed(2) + '% exceeds the typical 8% target for rental properties.<br>';
            } else if (results.cashOnCashReturn >= 4) {
                html += '• <strong>Good:</strong> Your cash-on-cash return of ' + results.cashOnCashReturn.toFixed(2) + '% is reasonable, though there may be better opportunities.<br>';
            } else if (results.cashOnCashReturn >= 0) {
                html += '• <strong>Consider carefully:</strong> Your cash-on-cash return of ' + results.cashOnCashReturn.toFixed(2) + '% is below typical investment standards.<br>';
            } else {
                html += '• <strong>Warning:</strong> Negative return of ' + results.cashOnCashReturn.toFixed(2) + '% means you\'re losing money on this investment.<br>';
            }
            
            if (results.capRate >= 8) {
                html += '• <strong>Strong Cap Rate:</strong> At ' + results.capRate.toFixed(2) + '%, this property shows solid earning potential.<br>';
            } else if (results.capRate >= 5) {
                html += '• <strong>Moderate Cap Rate:</strong> At ' + results.capRate.toFixed(2) + '%, returns are in the acceptable range.<br>';
            } else if (results.capRate >= 0) {
                html += '• <strong>Low Cap Rate:</strong> At ' + results.capRate.toFixed(2) + '%, this may not be an ideal investment property.<br>';
            }
            
            html += '</div>';
            
            // Next Steps
            html += '<div class="info-box">';
            html += '<strong>🎯 Next Steps</strong><br><br>';
            html += '• <strong>Due Diligence:</strong> Conduct thorough property inspection and review comparable properties<br>';
            html += '• <strong>Verify Numbers:</strong> Confirm rental rates, property taxes, and insurance costs with local data<br>';
            html += '• <strong>Consider Appreciation:</strong> Factor in potential property value growth over time<br>';
            html += '• <strong>Plan for Reserves:</strong> Set aside 3-6 months of expenses for unexpected costs<br>';
            html += '• <strong>Tax Benefits:</strong> Consult with a tax professional about deductions and depreciation';
            html += '</div>';
            
            html += '</div>';
            return html;
        }

        function formatCurrency(value) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(value);
        }

        function saveData() {
            const data = {
                propertyAddress: document.getElementById('propertyAddress').value,
                purchasePrice: document.getElementById('purchasePrice').value,
                downPayment: document.getElementById('downPayment').value,
                interestRate: document.getElementById('interestRate').value,
                loanTerm: document.getElementById('loanTerm').value,
                closingCosts: document.getElementById('closingCosts').value,
                oneTimeCosts: document.getElementById('oneTimeCosts').value,
                monthlyRent: document.getElementById('monthlyRent').value,
                propertyTax: document.getElementById('propertyTax').value,
                insurance: document.getElementById('insurance').value,
                maintenance: document.getElementById('maintenance').value,
                hoaFees: document.getElementById('hoaFees').value,
                otherCosts: document.getElementById('otherCosts').value,
                vacancy: document.getElementById('vacancy').value,
                propertyMgmt: document.getElementById('propertyMgmt').value
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            const address = data.propertyAddress ? data.propertyAddress.replace(/[^a-z0-9]/gi, '_') : 'property';
            a.download = `rental_investment_${address}_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function loadData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    document.getElementById('propertyAddress').value = data.propertyAddress || '';
                    document.getElementById('purchasePrice').value = data.purchasePrice || 0;
                    document.getElementById('downPayment').value = data.downPayment || 0;
                    document.getElementById('interestRate').value = data.interestRate || 0;
                    document.getElementById('loanTerm').value = data.loanTerm || 0;
                    document.getElementById('closingCosts').value = data.closingCosts || 0;
                    document.getElementById('oneTimeCosts').value = data.oneTimeCosts || 0;
                    document.getElementById('monthlyRent').value = data.monthlyRent || 0;
                    document.getElementById('propertyTax').value = data.propertyTax || 0;
                    document.getElementById('insurance').value = data.insurance || 0;
                    document.getElementById('maintenance').value = data.maintenance || 0;
                    document.getElementById('hoaFees').value = data.hoaFees || 0;
                    document.getElementById('otherCosts').value = data.otherCosts || 0;
                    document.getElementById('vacancy').value = data.vacancy || 0;
                    document.getElementById('propertyMgmt').value = data.propertyMgmt || 0;

                    alert('Data loaded successfully!');
                } catch (error) {
                    alert('Error loading file. Please make sure it is a valid JSON file.');
                }
            };
            reader.readAsText(file);
        }

        function printReport() {
            window.print();
        }

        function emailReport() {
            const address = document.getElementById('propertyAddress').value || 'Property';
            const resultsDiv = document.getElementById('results');
            
            if (resultsDiv.style.display === 'none') {
                alert('Please calculate the investment results first before emailing.');
                return;
            }

            const subject = `Rental Investment Analysis - ${address}`;
            const body = `Rental Investment Analysis Report\n\n` +
                `Property: ${address}\n` +
                `Purchase Price: ${document.getElementById('purchasePrice').value}\n` +
                `Monthly Rent: ${document.getElementById('monthlyRent').value}\n\n` +
                `View the complete analysis at: ${window.location.href}\n\n` +
                `Note: Please calculate and review the full report for detailed metrics.`;

            window.location.href = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        }
    </script>
</body>
</html>
